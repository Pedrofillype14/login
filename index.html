<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - ADD</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: #eef3f7;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .login-card {
            width: 380px;
            padding: 30px;
            border-radius: 12px;
            background: white;
            box-shadow: 0 0 25px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

<div class="login-card">
    <h3 class="text-center mb-4">üîê Login ADD</h3>

    <label class="form-label">Matr√≠cula:</label>
    <input type="text" id="matricula" class="form-control mb-3" placeholder="Digite sua matr√≠cula">

    <label class="form-label">Senha:</label>
    <input type="password" id="senha" class="form-control mb-4" placeholder="Digite sua senha">

    <button class="btn btn-primary w-100" onclick="logar()">Entrar</button>

    <p class="text-center text-danger mt-3" id="erro"></p>
</div>

<input type="text" id="matricula" placeholder="Matr√≠cula">
<input type="password" id="senha" placeholder="Senha">

<button onclick="logar()">Entrar</button>

<p id="erro" style="color:red; display:none;"></p>

<script>
async function logar() {
    const matricula = document.getElementById("matricula").value.trim();
    const senha = document.getElementById("senha").value.trim();
    const erroMsg = document.getElementById("erro");

    erroMsg.style.display = "none";

    try {
        const resp = await fetch("https://long-hall-0aaa.pedro-fillype.workers.dev/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ matricula, senha })
        });

        const data = await resp.json().catch(e => ({
            ok: false,
            error: "JSON inv√°lido: " + e
        }));

        console.log("Resposta do servidor:", data);

        if (!resp.ok || !data.ok) {
            erroMsg.textContent = data.error || "Erro desconhecido";
            erroMsg.style.display = "block";
            return;
        }

        // Login OK
        localStorage.setItem("matricula", matricula);
        window.location.href = "index.html";

    } catch (err) {
        erroMsg.textContent = "ERRO (catch): " + err;
        erroMsg.style.display = "block";
    }
}
</script>
</body>
</html>
